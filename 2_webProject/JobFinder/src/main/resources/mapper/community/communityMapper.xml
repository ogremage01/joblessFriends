<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.joblessfriend.jobfinder.community">

	<resultMap type="CommunityVo" id="communityResultVo">
		<id column="COMMUNITY_ID" property="communityId" />
		<result column="MEMBER_ID" property="memberId" />
		<result column="NICKNAME" property="nickname" />
		<result column="TITLE" property="title" />
		<result column="CONTENT" property="content" />
		<result column="CREATE_AT" property="createAt"
			javaType="java.util.Date" />
		<result column="MODIFIED_AT" property="modifiedAt"
			javaType="java.util.Date" />
		<result column="VIEWS" property="views" />
	</resultMap>
	<!--커뮤니티|칼럼 : 게시글 작성-->
	
	<insert id="communityInsertOne" parameterType="com.joblessfriend.jobfinder.community.domain.CommunityVo" keyProperty="communityId">
		INSERT INTO COMMUNITY (COMMUNITY_ID, MEMBER_ID, TITLE, CONTENT, CREATE_AT, MODIFIED_AT, VIEWS)
		VALUES(COMMUNITY_ID_SEQ.NEXTVAL, #{memberId}, #{title}, #{content}, SYSDATE, NULL, 0)
	</insert>
	
	<select id="communitySelectList" parameterType="com.joblessfriend.jobfinder.community.domain.CommunityVo" resultMap="communityResultVo">
		<![CDATA[
			SELECT COMMUNITY_ID, MEMBER_ID, TITLE, CONTENT, CREATE_AT, MODIFIED_AT, VIEWS
			FROM COMMUNITY
		]]>
	</select>
	
	<select id="communitySelectOne" parameterType="int" resultMap="communityResultVo">
			SELECT COMM.COMMUNITY_ID, COMM.MEMBER_ID, COMM.TITLE, COMM.CONTENT, COMM.CREATE_AT, COMM.MODIFIED_AT, COMM.VIEWS, MEM.NICKNAME
			FROM COMMUNITY COMM INNER JOIN MEMBER MEM
			ON COMM.MEMBER_ID = MEM.MEMBER_ID
			WHERE COMM.COMMUNITY_ID = #{communityId}
	</select>
	
	<update id="communityUpdate" parameterType="com.joblessfriend.jobfinder.community.domain.CommunityVo" keyProperty="communityId">
			UPDATE COMMUNITY SET TITLE = #{title}, CONTENT = #{content} , MODIFIED_AT = SYSDATE
			WHERE COMMUNITY_ID = #{communityId}
	</update>
	
	<delete id="communityDelete" parameterType="int">
		DELETE FROM COMMUNITY
		WHERE COMMUNITY_ID = #{communityId}
	</delete>
	
	<insert id="communityFileInsert" parameterType="map">
		INSERT INTO COMMUNITY_FILE (COMMUNITY_FILE_ID, COMMUNITY_ID, FILE_NAME, STORED_FILE_NAME, FILE_SIZE, CREATE_AT, MODIFIED_AT)
		VALUES(COMMUNITY_FILE_ID_SEQ.NEXTVAL, #{parentId}, #{originalFileName}, #{storedFileName}, #{fileSize}, SYSDATE, NULL)
	</insert>
	

</mapper>